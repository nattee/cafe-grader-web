= turbo_frame_tag :problem_helpers do
  .card.mb-3.shadow-sm{data: {turbo: true}}
    .card-body
      .row.mb-3
        .col-6
          %h5.mb-0 Helper
        .col-6.text-end
          .text-end
            %a{href: "#", data: { bs_toggle: :modal, bs_target: '#helpers_help' } } [ What's this? ]
      -# hints
      - @problem.comments_with_reveal_status(@current_user,kind: [:hint]).each do |hint|
        .row
          .col-8
            .badge.rounded-pill.text-success.bg-success-subtle.me-2 Hint
            #{hint.title}
          .col-4.text-end
            -# view the hint
            - if hint.is_acquired?
              = link_to 'View', problem_hint_path(@problem,hint), data: {turbo_stream: true}
            - else
              - body_text = render partial: 'problems/acquire_hint_confirm', locals: {hint: hint}
              - confirmation = {title: "Confirm getting a hint", body: body_text}
              = link_to 'Get', acquire_problem_hint_path(@problem,hint), data: {turbo_stream: true, turbo_method: 'POST', turbo_confirm: confirmation.to_json}

      -# GenAI
      - if @assists
        - @assists.each do |assist|
          .row
            .col
              .badge.rounded-pill.text-primary.bg-primary-subtle.me-2 AI
              = assist.title
            .col-auto.text-end
              = link_to 'View', submission_comment_path(@submission,assist), data: {turbo_stream: true}
    -# GenAI request
    - if @models && @models.any?
      .card-footer
        - @models.each do |model|
          .row
            - body_text = render partial: 'comments/acquire_llm_assist_confirm', locals: {cost: 0,model: model}
            - confirmation = {title: "Confirm Submission for AI Help", body: body_text}
            .col
              AI help by
              %code #{model}
            .col-auto.pb-0.text-end
              = link_to "Get", llm_assist_submission_comments_path(@submission,model), data: {turbo: true, turbo_method: 'POST', turbo_confirm: confirmation.to_json }

  -# usage modal
  .modal.fade#helpers_help{tabindex: -1,role: 'dialog'}
    .modal-dialog{role:'document'}
      .modal-content
        .modal-header
          %h4 What are helpers?
          %button.btn-close{type: 'button', data: {bs: {dismiss: :modal}}, aria: {label: 'Close'}}
        .modal-body
          There are two kinds of helpers.
          %ul
            %li.mb-2
              %strong Problem Hints
              are hints for this specific problem. The hint is pre-built according to 
              the problem description without considering your submission.
            %li.mb-2
              %strong Submission Help
              is a specific helps on this particular submission. 
              The help is generated by anaysing your submission and evaluation result
              mainly by an LLM.
